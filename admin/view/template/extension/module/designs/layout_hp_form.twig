{{ header }}{{ column_left }}
<div id="content">
  <div class="page-header">
    <div class="container-fluid">
      <div class="pull-right">
        <button type="submit" form="form-layout" data-toggle="tooltip" title="{{ button_save }}" class="btn btn-primary"><i class="fa fa-save"></i></button>
        <a href="{{ cancel }}" data-toggle="tooltip" title="{{ button_cancel }}" class="btn btn-default"><i class="fa fa-reply"></i></a></div>
      <h1>{{ heading_title }}</h1>
      <ul class="breadcrumb">
        {% for breadcrumb in breadcrumbs %}
        <li><a href="{{ breadcrumb.href }}">{{ breadcrumb.text }}</a></li>
        {% endfor %}
      </ul>
    </div>
  </div>
  <div class="container-fluid">
    {% if error_warning %}
    <div class="alert alert-danger alert-dismissible"><i class="fa fa-exclamation-circle"></i> {{ error_warning }}
      <button type="button" class="close" data-dismiss="alert">&times;</button>
    </div>
    {% endif %}
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title"><i class="fa fa-pencil"></i> {{ text_form }}</h3>
      </div>
      <div class="panel-body">
        <form action="{{ action }}" method="post" enctype="multipart/form-data" id="form-layout" class="form-horizontal">
          <fieldset>
            <legend>{{ text_route }}</legend>
            <div class="form-group required">
              <label class="col-sm-2 control-label" for="input-name">{{ entry_name }}</label>
              <div class="col-sm-10">
                <input type="text" name="name" value="{{ name }}" placeholder="{{ entry_name }}" id="input-name" class="form-control" />
                {% if error_name %}
                <div class="text-danger">{{ error_name }}</div>
                {% endif %}
              </div>
            </div>
            <table id="route" class="table table-striped table-bordered table-hover">
              <thead>
                <tr>
                  <td class="text-left">{{ entry_store }}</td>
                  <td class="text-left">{{ entry_route }}</td>
                  <td></td>
                </tr>
              </thead>
              <tbody>
                {% set route_row = 0 %}
                {% for layout_route in layout_routes %}
                <tr id="route-row{{ route_row }}">
                  <td class="text-left"><select name="layout_route[{{ route_row }}][store_id]" class="form-control">
                      <option value="0">{{ text_default }}</option>
                      {% for store in stores %}
                      {% if store.store_id == layout_route.store_id %}
                      <option value="{{ store.store_id }}" selected="selected">{{ store.name }}</option>
                      {% else %}
                      <option value="{{ store.store_id }}">{{ store.name }}</option>
                      {% endif %}
                      {% endfor %}
                    </select></td>
                  <td class="text-left"><input type="text" name="layout_route[{{ route_row }}][route]" value="{{ layout_route.route }}" placeholder="{{ entry_route }}" class="form-control" /></td>
                  <td class="text-left"><button type="button" onclick="$('#route-row{{ route_row }}').remove();" data-toggle="tooltip" title="{{ button_remove }}" class="btn btn-danger"><i class="fa fa-minus-circle"></i></button></td>
                </tr>
                {% set route_row = route_row + 1 %}
                {% endfor %}
              </tbody>
              <tfoot>
                <tr>
                  <td colspan="2"></td>
                  <td class="text-left"><button type="button" onclick="addRoute();" data-toggle="tooltip" title="{{ button_route_add }}" class="btn btn-primary"><i class="fa fa-plus-circle"></i></button></td>
                </tr>
              </tfoot>
            </table>
          </fieldset>
          <fieldset>
            <legend>{{ text_module }}
                <a target="_blank" data-toggle="tooltip" title="" data-original-title="{{ hp_name_titles }}" class="pull-right btn btn-danger" href="https://awaro.ru/" role="button">
                    <i class="fa fa-cogs" aria-hidden="true"></i>&nbsp; {{ hp_name }}</a>
            </legend>
            {% set module_row = 0 %}
            <div class="row hyper-positions">
              <div class="col-sm-12 1 pos-sliders">
                  <div class="col-sm-12 text-center positions-name">{{ text_pos_sliders }}
                      <div class="input-group pull-right" data-toggle="tooltip" title="" data-original-title="{{ width_title }}">
                          <input class="bootstrap-switcher form-control" type="checkbox" value="1"
                                 name="hyper_positions_width[pos_sliders]" data-size="small" data-on-color="success"
                                  {% if (hyper_positions_width['pos_sliders'] is defined and hyper_positions_width['pos_sliders'] == 1) %} {{ 'checked' }}{% endif %} >
                      </div>
                  </div>
                  <table id="module-pos-sliders" class="table table-striped table-bordered table-hover">
                    <thead><tr><td class="text-center"></td></tr></thead>
                    <tbody>
                      {% for layout_module in layout_modules %}
                          {% if layout_module.position == 'pos_sliders' %}
                              <tr id="module-row{{ module_row }}">
                                  <td class="text-left"><div class="input-group">
                                          <select name="layout_module[{{ module_row }}][code]" class="form-control input-sm">
                                              {% for extension in extensions %}
                                                  <optgroup label="{{ extension.name }}">
                                                      {% if not extension.module %}
                                                          {% if extension.code == layout_module.code %}
                                                              <option value="{{ extension.code }}" selected="selected">{{ extension.name }}</option>
                                                          {% else %}
                                                              <option value="{{ extension.code }}">{{ extension.name }}</option>
                                                          {% endif %}
                                                      {% else %}
                                                          {% for module in extension.module %}
                                                              {% if module.code == layout_module.code %}
                                                                  <option value="{{ module.code }}" selected="selected">{{ module.name }}</option>
                                                              {% else %}
                                                                  <option value="{{ module.code }}">{{ module.name }}</option>
                                                              {% endif %}
                                                          {% endfor %}
                                                      {% endif %}
                                                  </optgroup>
                                              {% endfor %}
                                          </select>
                                          <input type="hidden" name="layout_module[{{ module_row }}][position]" value="{{ layout_module.position }}" />
                                          <input type="hidden" name="layout_module[{{ module_row }}][sort_order]" value="{{ layout_module.sort_order }}" />
                                          <div class="input-group-btn"> <a href="{{ layout_module.edit }}" type="button" data-toggle="tooltip" title="{{ button_edit }}" target="_blank" class="btn btn-primary btn-sm"><i class="fa fa-pencil"></i></a>
                                              <button type="button" onclick="$('#module-row{{ module_row }}').remove();" data-toggle="tooltip" title="{{ button_remove }}" class="btn btn-danger btn-sm"><i class="fa fa fa-minus-circle"></i></button>
                                          </div>
                                      </div></td>
                              </tr>
                              {% set module_row = module_row + 1 %}
                          {% endif %}
                      {% endfor %}
                    </tbody>
                    <tfoot>
                      <tr>
                          <td class="text-left"><div class="input-group">
                                  <select class="form-control input-sm">
                                      <option value=""></option>
                                      {% for extension in extensions %}
                                          <optgroup label="{{ extension.name }}">
                                              {% if not extension.module %}
                                                  <option value="{{ extension.code }}">{{ extension.name }}</option>
                                              {% else %}
                                                  {% for module in extension.module %}
                                                      <option value="{{ module.code }}">{{ module.name }}</option>
                                                  {% endfor %}
                                              {% endif %}
                                          </optgroup>
                                      {% endfor %}
                                  </select>
                                  <div class="input-group-btn">
                                      <button type="button" onclick="addModule('pos-sliders');" data-toggle="tooltip" title="{{ button_module_add }}" class="btn btn-primary btn-sm"><i class="fa fa-plus-circle"></i></button>
                                  </div>
                              </div>
                          </td>
                      </tr>
                    </tfoot>
                  </table>
              </div>
              <div class="col-sm-12 3 pos-content">
                <div class="row">
                  <div class="text-center col-sm-12">
                    <div class="col-sm-12 positions-name">{{ text_content_pos }}</div>
                  </div>
                  <div class="col-lg-3 col-md-4 col-sm-12">
                    <table id="module-column-left" class="table table-striped table-bordered table-hover">
                      <thead>
                        <tr>
                          <td class="text-center">{{ text_column_left }}</td>
                        </tr>
                      </thead>
                      <tbody>
                        {% for layout_module in layout_modules %}
                        {% if layout_module.position == 'column_left' %}
                        <tr id="module-row{{ module_row }}">
                          <td class="text-left"><div class="input-group">
                              <select name="layout_module[{{ module_row }}][code]" class="form-control input-sm">
                                {% for extension in extensions %}
                                <optgroup label="{{ extension.name }}">
                                {% if not extension.module %}
                                {% if extension.code == layout_module.code %}
                                <option value="{{ extension.code }}" selected="selected">{{ extension.name }}</option>
                                {% else %}
                                <option value="{{ extension.code }}">{{ extension.name }}</option>
                                {% endif %}
                                {% else %}
                                {% for module in extension.module %}
                                {% if module.code == layout_module.code %}
                                <option value="{{ module.code }}" selected="selected">{{ module.name }}</option>
                                {% else %}
                                <option value="{{ module.code }}">{{ module.name }}</option>
                                {% endif %}
                                {% endfor %}
                                {% endif %}
                                </optgroup>
                                {% endfor %}
                              </select>
                              <input type="hidden" name="layout_module[{{ module_row }}][position]" value="{{ layout_module.position }}" />
                              <input type="hidden" name="layout_module[{{ module_row }}][sort_order]" value="{{ layout_module.sort_order }}" />
                              <div class="input-group-btn"><a href="{{ layout_module.edit }}" type="button" data-toggle="tooltip" title="{{ button_edit }}" target="_blank" class="btn btn-primary btn-sm"><i class="fa fa-pencil"></i></a>
                                <button type="button" onclick="$('#module-row{{ module_row }}').remove();" data-toggle="tooltip" title="{{ button_remove }}" class="btn btn-danger btn-sm"><i class="fa fa fa-minus-circle"></i></button>
                              </div>
                            </div></td>
                        </tr>
                        {% set module_row = module_row + 1 %}
                        {% endif %}
                        {% endfor %}
                      </tbody>
                      <tfoot>
                        <tr>
                          <td class="text-left"><div class="input-group">
                              <select class="form-control input-sm">
                                <option value=""></option>
                                {% for extension in extensions %}
                                <optgroup label="{{ extension.name }}">
                                {% if not extension.module %}
                                <option value="{{ extension.code }}">{{ extension.name }}</option>
                                {% else %}
                                {% for module in extension.module %}
                                <option value="{{ module.code }}">{{ module.name }}</option>
                                {% endfor %}
                                {% endif %}
                                </optgroup>
                                {% endfor %}
                              </select>
                              <div class="input-group-btn">
                                <button type="button" onclick="addModule('column-left');" data-toggle="tooltip" title="{{ button_module_add }}" class="btn btn-primary btn-sm"><i class="fa fa-plus-circle"></i></button>
                              </div>
                            </div></td>
                        </tr>
                      </tfoot>
                    </table>
                  </div>
                  <div class="col-lg-6 col-md-4 col-sm-12">
                    <table id="module-content-top" class="table table-striped table-bordered table-hover">
                      <thead>
                        <tr>
                          <td class="text-center">{{ text_content_top }}</td>
                        </tr>
                      </thead>
                      <tbody>
                        {% for layout_module in layout_modules %}
                        {% if layout_module.position == 'content_top' %}
                        <tr id="module-row{{ module_row }}">
                          <td class="text-left"><div class="input-group">
                              <select name="layout_module[{{ module_row }}][code]" class="form-control input-sm">
                                {% for extension in extensions %}
                                <optgroup label="{{ extension.name }}">
                                {% if not extension.module %}
                                {% if extension.code == layout_module.code %}
                                <option value="{{ extension.code }}" selected="selected">{{ extension.name }}</option>
                                {% else %}
                                <option value="{{ extension.code }}">{{ extension.name }}</option>
                                {% endif %}
                                {% else %}
                                {% for module in extension.module %}
                                {% if module.code == layout_module.code %}
                                <option value="{{ module.code }}" selected="selected">{{ module.name }}</option>
                                {% else %}
                                <option value="{{ module.code }}">{{ module.name }}</option>
                                {% endif %}
                                {% endfor %}
                                {% endif %}
                                </optgroup>
                                {% endfor %}
                              </select>
                              <input type="hidden" name="layout_module[{{ module_row }}][position]" value="{{ layout_module.position }}" />
                              <input type="hidden" name="layout_module[{{ module_row }}][sort_order]" value="{{ layout_module.sort_order }}" />
                              <div class="input-group-btn"> <a href="{{ layout_module.edit }}" type="button" data-toggle="tooltip" title="{{ button_edit }}" target="_blank" class="btn btn-primary btn-sm"><i class="fa fa-pencil"></i></a>
                                <button type="button" onclick="$('#module-row{{ module_row }}').remove();" data-toggle="tooltip" title="{{ button_remove }}" class="btn btn-danger btn-sm"><i class="fa fa fa-minus-circle"></i></button>
                              </div>
                            </div></td>
                        </tr>
                        {% set module_row = module_row + 1 %}
                        {% endif %}
                        {% endfor %}
                      </tbody>
                      <tfoot>
                        <tr>
                          <td class="text-left"><div class="input-group">
                              <select class="form-control input-sm">
                                <option value=""></option>
                                {% for extension in extensions %}
                                <optgroup label="{{ extension.name }}">
                                {% if not extension.module %}
                                <option value="{{ extension.code }}">{{ extension.name }}</option>
                                {% else %}
                                {% for module in extension.module %}
                                <option value="{{ module.code }}">{{ module.name }}</option>
                                {% endfor %}
                                {% endif %}
                                </optgroup>
                                {% endfor %}
                              </select>
                              <div class="input-group-btn">
                                <button type="button" onclick="addModule('content-top');" data-toggle="tooltip" title="{{ button_module_add }}" class="btn btn-primary btn-sm"><i class="fa fa-plus-circle"></i></button>
                              </div>
                            </div></td>
                        </tr>
                      </tfoot>
                    </table>
                    <table id="module-content-bottom" class="table table-striped table-bordered table-hover">
                      <thead>
                        <tr>
                          <td class="text-center">{{ text_content_bottom }}</td>
                        </tr>
                      </thead>
                      <tbody>
                        {% for layout_module in layout_modules %}
                        {% if layout_module.position == 'content_bottom' %}
                        <tr id="module-row{{ module_row }}">
                          <td class="text-left"><div class="input-group">
                              <select name="layout_module[{{ module_row }}][code]" class="form-control input-sm">
                                {% for extension in extensions %}
                                <optgroup label="{{ extension.name }}">
                                {% if not extension.module %}
                                {% if extension.code == layout_module.code %}
                                <option value="{{ extension.code }}" selected="selected">{{ extension.name }}</option>
                                {% else %}
                                <option value="{{ extension.code }}">{{ extension.name }}</option>
                                {% endif %}
                                {% else %}
                                {% for module in extension.module %}
                                {% if module.code == layout_module.code %}
                                <option value="{{ module.code }}" selected="selected">{{ module.name }}</option>
                                {% else %}
                                <option value="{{ module.code }}">{{ module.name }}</option>
                                {% endif %}
                                {% endfor %}
                                {% endif %}
                                </optgroup>
                                {% endfor %}
                              </select>
                              <input type="hidden" name="layout_module[{{ module_row }}][position]" value="{{ layout_module.position }}" />
                              <input type="hidden" name="layout_module[{{ module_row }}][sort_order]" value="{{ layout_module.sort_order }}" />
                              <div class="input-group-btn"><a href="{{ layout_module.edit }}" type="button" data-toggle="tooltip" title="{{ button_edit }}" target="_blank" class="btn btn-primary btn-sm"><i class="fa fa-pencil"></i></a>
                                <button type="button" onclick="$('#module-row{{ module_row }}').remove();" data-toggle="tooltip" title="{{ button_remove }}" class="btn btn-danger btn-sm"><i class="fa fa fa-minus-circle"></i></button>
                              </div>
                            </div></td>
                        </tr>
                        {% set module_row = module_row + 1 %}
                        {% endif %}
                        {% endfor %}
                      </tbody>
                      <tfoot>
                        <tr>
                          <td class="text-left"><div class="input-group">
                              <select class="form-control input-sm">
                                <option value=""></option>
                                {% for extension in extensions %}
                                <optgroup label="{{ extension.name }}">
                                {% if not extension.module %}
                                <option value="{{ extension.code }}">{{ extension.name }}</option>
                                {% else %}
                                {% for module in extension.module %}
                                <option value="{{ module.code }}">{{ module.name }}</option>
                                {% endfor %}
                                {% endif %}
                                </optgroup>
                                {% endfor %}
                              </select>
                              <div class="input-group-btn">
                                <button type="button" onclick="addModule('content-bottom');" data-toggle="tooltip" title="{{ button_module_add }}" class="btn btn-primary btn-sm"><i class="fa fa-plus-circle"></i></button>
                              </div>
                            </div></td>
                        </tr>
                      </tfoot>
                    </table>
                  </div>
                  <div class="col-lg-3 col-md-4 col-sm-12">
                    <table id="module-column-right" class="table table-striped table-bordered table-hover">
                      <thead>
                        <tr>
                          <td class="text-center">{{ text_column_right }}</td>
                        </tr>
                      </thead>
                      <tbody>
                        {% for layout_module in layout_modules %}
                        {% if layout_module.position == 'column_right' %}
                        <tr id="module-row{{ module_row }}">
                          <td class="text-left"><div class="input-group">
                              <select name="layout_module[{{ module_row }}][code]" class="form-control input-sm">
                                {% for extension in extensions %}
                                <optgroup label="{{ extension.name }}">
                                {% if not extension.module %}
                                {% if extension.code == layout_module.code %}
                                <option value="{{ extension.code }}" selected="selected">{{ extension.name }}</option>
                                {% else %}
                                <option value="{{ extension.code }}">{{ extension.name }}</option>
                                {% endif %}
                                {% else %}
                                {% for module in extension.module %}
                                {% if module.code == layout_module.code %}
                                <option value="{{ module.code }}" selected="selected">{{ module.name }}</option>
                                {% else %}
                                <option value="{{ module.code }}">{{ module.name }}</option>
                                {% endif %}
                                {% endfor %}
                                {% endif %}
                                </optgroup>
                                {% endfor %}
                              </select>
                              <input type="hidden" name="layout_module[{{ module_row }}][position]" value="{{ layout_module.position }}" />
                              <input type="hidden" name="layout_module[{{ module_row }}][sort_order]" value="{{ layout_module.sort_order }}" />
                              <div class="input-group-btn"><a href="{{ layout_module.edit }}" data-toggle="tooltip" title="{{ button_edit }}" target="_blank" class="btn btn-primary btn-sm"><i class="fa fa-pencil"></i></a>
                                <button type="button" onclick="$('#module-row{{ module_row }}').remove();" data-toggle="tooltip" title="{{ button_remove }}" class="btn btn-danger btn-sm"><i class="fa fa fa-minus-circle"></i></button>
                              </div>
                            </div></td>
                        </tr>
                        {% set module_row = module_row + 1 %}
                        {% endif %}
                        {% endfor %}
                      </tbody>
                      <tfoot>
                        <tr>
                          <td class="text-left"><div class="input-group">
                              <select class="form-control input-sm">
                                <option value=""></option>
                                {% for extension in extensions %}
                                <optgroup label="{{ extension.name }}">
                                {% if not extension.module %}
                                <option value="{{ extension.code }}">{{ extension.name }}</option>
                                {% else %}
                                {% for module in extension.module %}
                                <option value="{{ module.code }}">{{ module.name }}</option>
                                {% endfor %}
                                {% endif %}
                                </optgroup>
                                {% endfor %}
                              </select>
                              <div class="input-group-btn">
                                <button type="button" onclick="addModule('column-right');" data-toggle="tooltip" title="{{ button_module_add }}" class="btn btn-primary btn-sm"><i class="fa fa-plus-circle"></i></button>
                              </div>
                            </div></td>
                        </tr>
                      </tfoot>
                    </table>
                  </div>
                </div>
              </div>
          
			  <div class="col-sm-12 3 pos-map">
                <div class="row">
                  <div class="text-center col-sm-12">
                      <div class="col-sm-12 text-center positions-name">{{ text_map_pos }}
                          <div class="input-group pull-right" data-toggle="tooltip" title="" data-original-title="{{ width_title }}">
                              <input class="bootstrap-switcher form-control" type="checkbox" value="1"
                                     name="hyper_positions_width[pos_map]" data-size="small" data-on-color="success"
                                      {% if (hyper_positions_width['pos_map'] is defined and hyper_positions_width['pos_map'] == 1) %} {{ 'checked' }}{% endif %} >
                          </div>
                      </div>
                  </div>
                  <div class="col-sm-12">
                      <table id="module-map-center" class="table table-striped table-bordered table-hover">
                          <thead><tr><td class="text-center"></td></tr></thead>
                          <tbody>
                          {% for layout_module in layout_modules %}
                              {% if layout_module.position == 'map_center' %}
                                  <tr id="module-row{{ module_row }}">
                                      <td class="text-left"><div class="input-group">
                                              <select name="layout_module[{{ module_row }}][code]" class="form-control input-sm">
                                                  {% for extension in extensions %}
                                                      <optgroup label="{{ extension.name }}">
                                                          {% if not extension.module %}
                                                              {% if extension.code == layout_module.code %}
                                                                  <option value="{{ extension.code }}" selected="selected">{{ extension.name }}</option>
                                                              {% else %}
                                                                  <option value="{{ extension.code }}">{{ extension.name }}</option>
                                                              {% endif %}
                                                          {% else %}
                                                              {% for module in extension.module %}
                                                                  {% if module.code == layout_module.code %}
                                                                      <option value="{{ module.code }}" selected="selected">{{ module.name }}</option>
                                                                  {% else %}
                                                                      <option value="{{ module.code }}">{{ module.name }}</option>
                                                                  {% endif %}
                                                              {% endfor %}
                                                          {% endif %}
                                                      </optgroup>
                                                  {% endfor %}
                                              </select>
                                              <input type="hidden" name="layout_module[{{ module_row }}][position]" value="{{ layout_module.position }}" />
                                              <input type="hidden" name="layout_module[{{ module_row }}][sort_order]" value="{{ layout_module.sort_order }}" />
                                              <div class="input-group-btn"><a href="{{ layout_module.edit }}" type="button" data-toggle="tooltip" title="{{ button_edit }}" target="_blank" class="btn btn-primary btn-sm"><i class="fa fa-pencil"></i></a>
                                                  <button type="button" onclick="$('#module-row{{ module_row }}').remove();" data-toggle="tooltip" title="{{ button_remove }}" class="btn btn-danger btn-sm"><i class="fa fa fa-minus-circle"></i></button>
                                              </div>
                                          </div>
                                      </td>
                                  </tr>
                                  {% set module_row = module_row + 1 %}
                              {% endif %}
                          {% endfor %}
                          </tbody>
                          <tfoot>
                          <tr>
                              <td class="text-left"><div class="input-group">
                                      <select class="form-control input-sm">
                                          <option value=""></option>
                                          {% for extension in extensions %}
                                              <optgroup label="{{ extension.name }}">
                                                  {% if not extension.module %}
                                                      <option value="{{ extension.code }}">{{ extension.name }}</option>
                                                  {% else %}
                                                      {% for module in extension.module %}
                                                          <option value="{{ module.code }}">{{ module.name }}</option>
                                                      {% endfor %}
                                                  {% endif %}
                                              </optgroup>
                                          {% endfor %}
                                      </select>
                                      <div class="input-group-btn">
                                          <button type="button" onclick="addModule('map-center');" data-toggle="tooltip" title="{{ button_module_add }}" class="btn btn-primary btn-sm"><i class="fa fa-plus-circle"></i></button>
                                      </div>
                                  </div>
                              </td>
                          </tr>
                          </tfoot>
                      </table>
                  </div>
                </div>
              </div>
            </div>
          </fieldset>
        </form>
      </div>
    </div>
  </div>
<script><!--
var route_row = {{ route_row }};

function addRoute() {
	html  = '<tr id="route-row' + route_row + '">';
	html += '  <td class="text-left"><select name="layout_route[' + route_row + '][store_id]" class="form-control">';
	html += '  <option value="0">{{ text_default }}</option>';
	{% for store in stores %}
	html += '<option value="{{ store.store_id }}">{{ store.name|escape('js') }}</option>';
	{% endfor %}
	html += '  </select></td>';
	html += '  <td class="text-left"><input type="text" name="layout_route[' + route_row + '][route]" value="" placeholder="{{ entry_route }}" class="form-control" /></td>';
	html += '  <td class="text-left"><button type="button" onclick="$(\'#route-row' + route_row + '\').remove();" data-toggle="tooltip" title="{{ button_remove }}" class="btn btn-danger"><i class="fa fa-minus-circle"></i></button></td>';
	html += '</tr>';
	
	$('#route tbody').append(html);
	
	route_row++;
}

var module_row = {{ module_row }};

function addModule(type) {
	html  = '<tr id="module-row' + module_row + '">';
    html += '  <td class="text-left"><div class="input-group"><select name="layout_module[' + module_row + '][code]" class="form-control input-sm">';
	{% for extension in extensions %}
	html += '    <optgroup label="{{ extension.name|escape('js') }}">';
	{% if not extension.module %}
	html += '      <option value="{{ extension.code }}">{{ extension.name|escape('js') }}</option>';
	{% else %}
	{% for module in extension.module %}
	html += '      <option value="{{ module.code }}">{{ module.name|escape('js') }}</option>';
	{% endfor %}
	{% endif %}
	html += '    </optgroup>';
	{% endfor %}
	html += '  </select>';
    html += '  <input type="hidden" name="layout_module[' + module_row + '][position]" value="' + type.replace('-', '_') + '" />';
    html += '  <input type="hidden" name="layout_module[' + module_row + '][sort_order]" value="" />';
	html += '  <div class="input-group-btn"><a href="" target="_blank" type="button" data-toggle="tooltip" title="{{ button_edit }}" class="btn btn-primary btn-sm"><i class="fa fa-pencil"></i></a><button type="button" onclick="$(\'#module-row' + module_row + '\').remove();" data-toggle="tooltip" title="{{ button_remove }}" class="btn btn-danger btn-sm"><i class="fa fa fa-minus-circle"></i></button></div></div></td>';
	html += '</tr>';
	
	$('#module-' + type + ' tbody').append(html);
	
	$('#module-' + type + ' tbody select[name=\'layout_module[' + module_row + '][code]\']').val($('#module-' + type + ' tfoot select').val());
	
	$('#module-' + type + ' select[name*=\'code\']').trigger('change');
		
	$('#module-' + type + ' tbody input[name*=\'sort_order\']').each(function(i, element) {
		$(element).val(i);
	});
	
	module_row++;
}

$('#module-pos-sliders, #module-column-left, #module-column-right, #module-content-top, #module-content-bottom, #module-map-center').delegate('select[name*=\'code\']', 'change', function() {
	var part = this.value.split('.');
	
	if (!part[1]) {
		$(this).parent().find('a').attr('href', 'index.php?route=extension/module/' + part[0] + '&user_token={{ user_token }}');
	} else {
		$(this).parent().find('a').attr('href', 'index.php?route=extension/module/' + part[0] + '&user_token={{ user_token }}&module_id=' + part[1]);
	}
});

$('#module-pos-sliders, #module-column-left, #module-column-right, #module-content-top, #module-content-bottom, #module-map-center').trigger('change');
//--></script>
<script type="text/javascript"><!--

  function initSwitcher(){
      $('.bootstrap-switcher').bootstrapSwitch({
          onInit: function(event, state) {
              switcher(event, state, this);
          },
          onSwitchChange: function(event, state) {
              switcher(event, state, this);
          }
      });
  }

  function switcher(event, state, $this) {
      if(state == true){
          $($this).parent().parent().parent().parent().find('a').attr("disabled", "true");
          $($this).parent().parent().parent().parent().find('a').attr("onclick", "return false");
      }else{
          $($this).parent().parent().parent().parent().find('a').removeAttr("disabled");
          $($this).parent().parent().parent().parent().find('a').removeAttr("onclick");
      }
  }

  $( document ).ready(function() {
      $('body').addClass('hyper-position hd-switch');

      initSwitcher();

  });

//--></script>
</div>
{{ footer }}
<style>
    .positions-name .input-group.pull-right {
        width: 46px;
    }
    .hyper-positions > div {
        background-color: ghostwhite;
        border: 2px solid rgba(1, 125, 255, 0.55);
        margin-bottom: 10px;
        padding-top: 10px;
    }
    .hyper-positions .form-control {
        padding: 0;
    }
    .hyper-positions > div:nth-child(2n+1){
        background-color: rgba(1, 125, 255, 0.1);
    }
    legend .btn-danger {
        color: #f8f8f8;
        font-size: 14px;
        font-weight: 600;
    }
    .positions-name {
        background-color: #f8f8f8;
        box-shadow: 0 0 3px #bdbdbd;
        color: #0068a6;
        font-size: 16px;
        font-weight: 600;
        line-height: 1.7;
        margin-bottom: 10px;
        padding: 10px;
    }
    .pos-content {
        border: 2px solid rgba(0, 0, 0, 0.45) !important;
    }
    .pos-contents {
        border: 2px solid rgba(0, 0, 0, 0.25) !important;
    }
    .pos-content .positions-name {
        color: teal;
    }
    .pos-contents .positions-name, .pos-header .positions-name {
        color: #c2c2c2;
    }
    .pos-header .positions-name {
        line-height: 1.6;
        padding: 5px 10px;
        margin-bottom: 0;
        box-shadow: 0 0 1px #bdbdbd;
    }
    .pos-header .positions-name + .positions-name {
        line-height: 4;
        margin-bottom: 0;
    }.pos-header .positions-name + .positions-name + .positions-name {
         line-height: 1.6;
         margin-bottom: 10px;
         padding: 10px;
     }
    .pos-footer3 + .pos-contents .positions-name {
        line-height: 4;
    }
</style>